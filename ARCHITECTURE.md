# Архитектура VibeCode Jam

## Обзор системы

**VibeCode Jam** — это платформа для проведения технических собеседований с браузерным IDE, системой оценки кандидатов и административным интерфейсом. Платформа построена на основе клиент-серверной архитектуры с использованием современных веб-технологий.

### Основные компоненты

```
┌─────────────────────────────────────────────────────────────────┐
│                      FRONTEND (React + Vite)                    │
│  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐      │
│  │   Candidates  │  │   Admin       │  │ Authentication│      │
│  │   Interface   │  │   Dashboard   │  │   Context     │      │
│  └───────┬───────┘  └───────┬───────┘  └───────┬───────┘      │
│          │                  │                  │               │
│          └──────────────────┴──────────────────┘               │
│                             │                                   │
│                    ┌────────▼────────┐                         │
│                    │  API Client     │                         │
│                    │  (Axios)        │                         │
│                    └────────┬────────┘                         │
└─────────────────────────────┼─────────────────────────────────┘
                              │
                    HTTP/REST API (JSON)
                              │
┌─────────────────────────────▼─────────────────────────────────┐
│                   BACKEND (Node.js + Express)                  │
│  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐     │
│  │  REST API     │  │  Sandbox      │  │  AI Service   │     │
│  │  Routes       │──┤  Engine       │  │  (OpenAI)     │     │
│  └───────┬───────┘  └───────────────┘  └───────────────┘     │
│          │                                                      │
│  ┌───────▼────────────────────────────────────────────┐       │
│  │           SQLite Database (vibecode.db)            │       │
│  │  ┌─────────┐ ┌─────────┐ ┌──────────┐ ┌────────┐ │       │
│  │  │ tasks   │ │sessions │ │submissions│ │ users  │ │       │
│  │  └─────────┘ └─────────┘ └──────────┘ └────────┘ │       │
│  │  ┌─────────────┐ ┌─────────────────────────────┐ │       │
│  │  │ challenges  │ │ anti_cheat_logs             │ │       │
│  │  └─────────────┘ └─────────────────────────────┘ │       │
│  └────────────────────────────────────────────────────┘       │
└────────────────────────────────────────────────────────────────┘
```

---

## Архитектура Frontend

### Технологический стек
- **React 19** — основной UI-фреймворк
- **Vite** — сборщик и dev-сервер
- **React Router** — маршрутизация
- **Monaco Editor** — редактор кода (как в VS Code)
- **Axios** — HTTP-клиент для взаимодействия с API
- **Vanilla CSS** — стилизация с темной темой

### Структура директорий

```
client/src/
├── components/         # Переиспользуемые компоненты
│   └── ProtectedRoute.jsx
├── context/           # React Context для глобального состояния
│   └── AuthContext.jsx
├── hooks/             # Пользовательские хуки
│   └── useAntiCheat.js
├── pages/             # Страницы приложения
│   ├── Welcome.jsx
│   ├── Qualification.jsx
│   ├── Workspace.jsx
│   ├── Report.jsx
│   ├── Admin.jsx
│   └── Login.jsx
├── App.jsx            # Главный компонент с роутингом
├── index.css          # Глобальные стили
└── main.jsx           # Точка входа
```

### Основные компоненты

#### 1. **AuthContext** (`context/AuthContext.jsx`)
Управляет состоянием аутентификации пользователя:
- Хранение токена и информации о пользователе в `localStorage`
- Методы `login()`, `logout()`, `isAuthenticated()`
- Проверка роли пользователя (candidate/admin)

#### 2. **ProtectedRoute** (`components/ProtectedRoute.jsx`)
Защищает маршруты от несанкционированного доступа:
- Проверяет аутентификацию перед отображением страницы
- Перенаправляет на `/login` при отсутствии токена
- Опциональная проверка роли (например, только для admin)

#### 3. **useAntiCheat** (`hooks/useAntiCheat.js`)
Хук для отслеживания подозрительной активности:
- **Copy/Paste Detection** — логирование всех операций копирования/вставки
- **Window Focus/Blur** — отслеживание переключения между окнами
- **Tab Visibility** — отслеживание переключения между вкладками
- Отправка событий на сервер через `/api/anticheat`

### Маршрутизация

```javascript
/                    → Welcome (главная страница)
/login              → Login (вход для кандидатов и админа)
/qualification      → Qualification (квалификационный тест)
/workspace          → Workspace (рабочее пространство с задачами)
/report/:sessionId  → Report (отчет о прохождении)
/admin              → Admin (админ-панель, защищенный маршрут)
```

---

## Архитектура Backend

### Технологический стек
- **Node.js 18+** — серверная платформа
- **Express** — веб-фреймворк
- **SQLite3** — встроенная база данных
- **VM Module** — изолированное исполнение кода
- **OpenAI API** — AI-сервис для ревью кода и генерации задач
- **dotenv** — управление переменными окружения

### Структура директорий

```
server/
├── server.js          # Главный файл сервера с маршрутами
├── db.js              # Инициализация БД и seed-данные
├── sandbox.js         # Песочница для выполнения кода
├── questions.js       # Вопросы квалификационного теста
├── vibecode.db        # Файл базы данных SQLite
└── package.json
```

### Основные модули

#### 1. **server.js** — API сервер
Основной Express-сервер, слушает на порту **3001**. Реализует REST API для:

**Задачи:**
- `GET /api/tasks` — получить все задачи (с фильтрацией по уровню)
- `GET /api/tasks/:id` — получить задачу по ID
- `POST /api/tasks` — создать новую задачу (admin)
- `POST /api/tasks/generate` — генерация задачи через AI

**Исполнение кода:**
- `POST /api/run` — запустить код с тестами
  - `type: 'test'` — видимые примеры
  - `type: 'submit'` — скрытые тестовые случаи

**Квалификационный тест:**
- `GET /api/qualification/questions` — получить вопросы теста
- `POST /api/qualification/submit` — отправить ответы и получить уровень

**Сессии и результаты:**
- `POST /api/sessions` — создать сессию собеседования
- `GET /api/sessions/:id` — получить результаты сессии
- `POST /api/sessions/:id/complete` — завершить сессию
- `POST /api/submissions` — сохранить код и результаты

**Челленджи:**
- `POST /api/challenges/start` — начать челлендж (3 задачи)
- `POST /api/challenges/:id/submit` — отправить решение задачи в челлендже
- `POST /api/challenges/:id/complete` — завершить челлендж
- `GET /api/challenges/user/:userId` — получить челленджи пользователя

**Аутентификация:**
- `POST /api/login` — вход кандидата/админа
- `POST /api/register` — регистрация кандидата (admin)
- `POST /api/change-password` — изменение пароля (admin)

**Анти-читинг:**
- `POST /api/anticheat` — логирование подозрительных событий

**AI функции:**
- `POST /api/review` — ревью кода с помощью AI

#### 2. **db.js** — база данных
Инициализирует SQLite базу данных и создает таблицы:

**Таблицы:**
- `tasks` — задачи для кодинга
- `sessions` — сессии кандидатов
- `submissions` — отправленные решения
- `users` — пользователи системы
- `challenges` — челленджи кандидатов
- `challenge_submissions` — решения в рамках челленджей
- `anti_cheat_logs` — логи подозрительной активности

Также содержит функцию `seedTasks()` для первоначального заполнения базы задачами.

#### 3. **sandbox.js** — песочница для кода
Безопасное выполнение пользовательского кода:

```javascript
runUserCode(userCode, tests, timeout = 1000)
```

**Механизмы безопасности:**
- Использование `vm.Script` для изоляции контекста
- Таймаут выполнения (1000ms для пользовательского кода)
- Таймаут для каждого теста (500ms)
- Блокировка опасных конструкций (`eval`, `Function`)
- Ограниченный контекст без доступа к `require`, `process`, `fs`

**Ограничения:**
⚠️ Текущая реализация НЕ защищена на 100% от:
- Бесконечных циклов
- Чрезмерного использования памяти
- Сетевых запросов
- Файловых операций

Для продакшена рекомендуется Docker-изоляция.

#### 4. **questions.js** — квалификационный тест
Содержит массив вопросов с вариантами ответов для определения уровня кандидата:
- Junior: базовые вопросы (переменные, циклы, массивы)
- Middle: алгоритмы, структуры данных
- Senior: архитектура, оптимизация, сложные алгоритмы

---

## Схема базы данных

### Таблицы и связи

```
┌─────────────┐         ┌──────────────┐         ┌──────────────┐
│    users    │         │   sessions   │         │ submissions  │
├─────────────┤         ├──────────────┤         ├──────────────┤
│ id (PK)     │─────┐   │ id (PK)      │────────▶│ id (PK)      │
│ username    │     │   │ candidate    │         │ session_id   │
│ password    │     │   │ level        │         │ task_id      │
│ role        │     │   │ start_time   │         │ code         │
│ created_at  │     │   │ end_time     │         │ status       │
│ qual_passed │     │   │ score        │         │ metrics      │
│ qual_level  │     │   └──────────────┘         │ timestamp    │
└─────────────┘     │           │                └──────────────┘
       │            │           │                        │
       │            │           │                        │
       │            │           ▼                        │
       │            │   ┌──────────────────┐            │
       │            │   │ anti_cheat_logs  │            │
       │            │   ├──────────────────┤            │
       │            └──▶│ session_id       │            │
       │                │ submission_id ◀──┘            │
       │                │ event_type       │
       │                │ timestamp        │
       │                │ details          │
       │                └──────────────────┘
       │
       │            ┌──────────────┐
       └───────────▶│ challenges   │
                    ├──────────────┤
                    │ id (PK)      │─────┐
                    │ user_id      │     │
                    │ level        │     │
                    │ task_ids     │     │
                    │ start_time   │     │
                    │ end_time     │     │
                    │ status       │     │
                    └──────────────┘     │
                            │            │
                            │            ▼
                            │    ┌─────────────────────┐
                            └───▶│ challenge_submssns  │
                                 ├─────────────────────┤
                                 │ id (PK)             │
                                 │ challenge_id        │
┌─────────────┐                 │ task_id          ◀──┐
│    tasks    │                 │ code                │
├─────────────┤                 │ passed              │
│ id (PK)     │─────────────────│ submitted_at        │
│ title       │                 └─────────────────────┘
│ description │
│ level       │
│ examples    │  (JSON)
│ tests       │  (JSON)
└─────────────┘
```

### Детальное описание таблиц

#### **tasks** — задачи для кодинга
| Поле | Тип | Описание |
|------|-----|----------|
| id | INTEGER PK | Уникальный идентификатор задачи |
| title | TEXT | Название задачи |
| description | TEXT | Описание задачи |
| level | TEXT | Уровень сложности: `junior`, `middle`, `senior` |
| examples | TEXT | JSON массив видимых примеров: `[{input, output}]` |
| tests | TEXT | JSON массив скрытых тестов: `[{code, expected}]` |

#### **users** — пользователи системы
| Поле | Тип | Описание |
|------|-----|----------|
| id | INTEGER PK | Уникальный идентификатор пользователя |
| username | TEXT UNIQUE | Имя пользователя (логин) |
| password | TEXT | Хэш пароля (SHA256) |
| role | TEXT | Роль: `candidate` или `admin` |
| created_at | INTEGER | Timestamp создания |
| qualification_passed | INTEGER | Флаг прохождения квалификации (0/1) |
| qualification_level | TEXT | Уровень после квалификации |

#### **sessions** — сессии собеседований
| Поле | Тип | Описание |
|------|-----|----------|
| id | INTEGER PK | Уникальный идентификатор сессии |
| candidate_name | TEXT | Имя кандидата |
| level | TEXT | Назначенный уровень сложности |
| start_time | INTEGER | Timestamp начала |
| end_time | INTEGER | Timestamp окончания |
| score | INTEGER | Общий балл |

#### **submissions** — решения задач
| Поле | Тип | Описание |
|------|-----|----------|
| id | INTEGER PK | Уникальный идентификатор решения |
| session_id | INTEGER FK | Ссылка на сессию |
| task_id | INTEGER FK | Ссылка на задачу |
| code | TEXT | Код решения |
| status | TEXT | Статус: `passed`, `failed`, `error` |
| metrics | TEXT | JSON с метриками (время, попытки и т.д.) |
| timestamp | INTEGER | Timestamp отправки |

#### **challenges** — челленджи кандидатов
| Поле | Тип | Описание |
|------|-----|----------|
| id | INTEGER PK | Уникальный идентификатор челленджа |
| user_id | INTEGER FK | Ссылка на пользователя |
| level | TEXT | Уровень сложности задач |
| task_ids | TEXT | JSON массив ID задач |
| start_time | INTEGER | Timestamp начала |
| end_time | INTEGER | Timestamp окончания |
| status | TEXT | Статус: `in_progress`, `completed` |

#### **challenge_submissions** — решения в челленджах
| Поле | Тип | Описание |
|------|-----|----------|
| id | INTEGER PK | Уникальный идентификатор |
| challenge_id | INTEGER FK | Ссылка на челлендж |
| task_id | INTEGER FK | Ссылка на задачу |
| code | TEXT | Код решения |
| passed | INTEGER | Флаг успешности (0/1) |
| submitted_at | INTEGER | Timestamp отправки |

#### **anti_cheat_logs** — логи подозрительной активности
| Поле | Тип | Описание |
|------|-----|----------|
| id | INTEGER PK | Уникальный идентификатор |
| session_id | INTEGER FK | Ссылка на сессию |
| submission_id | INTEGER FK | Ссылка на решение |
| event_type | TEXT | Тип события: `paste`, `blur`, `visibility_change` |
| timestamp | INTEGER | Timestamp события |
| details | TEXT | Дополнительная информация (JSON) |

---

## Флоу работы кандидата

### 1. Вход в систему
```
┌──────────────┐
│   /login     │
│              │
│  Кандидат    │
│  вводит      │
│  логин/      │
│  пароль      │
└──────┬───────┘
       │
       ▼
┌──────────────────────┐
│  POST /api/login     │
│                      │
│  Проверка в БД       │
│  Возврат токена      │
│  и данных юзера      │
└──────┬───────────────┘
       │
       ▼
┌──────────────────────┐
│  Сохранение в        │
│  localStorage:       │
│  - token             │
│  - user              │
│  - role              │
└──────┬───────────────┘
       │
       ▼
┌──────────────────────┐
│  qualification_      │
│  passed == 1?        │
└──────┬───────────────┘
       │
       ├─── НЕТ ────▶ Переход к квалификационному тесту
       │
       └─── ДА ─────▶ Переход к челленджу
```

### 2. Квалификационный тест (если не пройден)
```
┌──────────────────────┐
│  /qualification      │
│                      │
│  Получение вопросов: │
│  GET /api/           │
│  qualification/      │
│  questions           │
└──────┬───────────────┘
       │
       ▼
┌──────────────────────┐
│  Кандидат отвечает   │
│  на 10-15 вопросов   │
└──────┬───────────────┘
       │
       ▼
┌──────────────────────┐
│  POST /api/          │
│  qualification/      │
│  submit              │
│                      │
│  Отправка ответов    │
└──────┬───────────────┘
       │
       ▼
┌──────────────────────┐
│  Анализ результатов: │
│  - 0-40%   → Junior  │
│  - 40-70%  → Middle  │
│  - 70-100% → Senior  │
└──────┬───────────────┘
       │
       ▼
┌──────────────────────┐
│  Обновление users:   │
│  qualification_      │
│  passed = 1          │
│  qualification_      │
│  level = 'middle'    │
└──────┬───────────────┘
       │
       ▼
┌──────────────────────┐
│  Переход к           │
│  челленджу           │
└──────────────────────┘
```

### 3. Челлендж (3 задачи)
```
┌──────────────────────┐
│  Кнопка "Начать      │
│  челлендж"           │
└──────┬───────────────┘
       │
       ▼
┌──────────────────────┐
│  POST /api/          │
│  challenges/start    │
│                      │
│  Параметры:          │
│  - user_id           │
│  - level (из квалиф) │
└──────┬───────────────┘
       │
       ▼
┌──────────────────────┐
│  Создание записи     │
│  в challenges:       │
│  - task_ids: [1,5,9] │
│  - status:           │
│    'in_progress'     │
└──────┬───────────────┘
       │
       ▼
┌──────────────────────────────────────────────┐
│        /workspace (рабочее пространство)     │
│                                              │
│  ┌──────────────┐  ┌──────────────┐         │
│  │  Задача 1/3  │  │  Задача 2/3  │         │
│  └──────────────┘  └──────────────┘         │
│                                              │
│  ┌────────────────────────────────────────┐ │
│  │  Monaco Editor                         │ │
│  │  (редактирование кода)                 │ │
│  └────────────────────────────────────────┘ │
│                                              │
│  [Запустить тесты] [Отправить]              │
│                    [Переключить задачу]      │
└──────────────────────┬───────────────────────┘
                       │
                       ▼
         ┌─────────────────────────┐
         │  Кандидат переключается │
         │  между задачами         │
         │  (1, 2, 3)              │
         └─────────────┬───────────┘
                       │
                       ▼
         ┌─────────────────────────┐
         │  Для каждой задачи:     │
         │                         │
         │  1. Написать код        │
         │  2. Тестировать         │
         │     (POST /api/run)     │
         │  3. Отправить решение   │
         │     (POST /api/         │
         │      challenges/:id/    │
         │      submit)            │
         └─────────────┬───────────┘
                       │
                       ▼
         ┌─────────────────────────┐
         │  Запись в               │
         │  challenge_submissions  │
         └─────────────┬───────────┘
                       │
                       ▼
         ┌─────────────────────────┐
         │  Кнопка "Завершить      │
         │  челлендж"              │
         │                         │
         │  Если есть нерешенные:  │
         │  → Подтверждение        │
         └─────────────┬───────────┘
                       │
                       ▼
         ┌─────────────────────────┐
         │  POST /api/             │
         │  challenges/:id/        │
         │  complete               │
         │                         │
         │  Обновление:            │
         │  - status: 'completed'  │
         │  - end_time             │
         └─────────────┬───────────┘
                       │
                       ▼
         ┌─────────────────────────┐
         │  /report/:challengeId   │
         │                         │
         │  Отображение:           │
         │  - Время прохождения    │
         │  - Решенные задачи      │
         │  - Баллы                │
         │  - Рекомендации AI      │
         └─────────────────────────┘
```

### 4. Анти-чит механизмы
На протяжении всего челленджа работает хук `useAntiCheat`:

```
┌──────────────────────────────────────────────┐
│  События отслеживания:                       │
│                                              │
│  1. Copy/Paste                               │
│     → Логируется вставленный текст           │
│                                              │
│  2. Window Blur/Focus                        │
│     → Определяется переключение между окнами │
│                                              │
│  3. Tab Visibility Change                    │
│     → Переключение вкладок браузера          │
└──────────────────┬───────────────────────────┘
                   │
                   ▼
         ┌─────────────────────┐
         │  POST /api/anticheat│
         │                     │
         │  Отправка:          │
         │  - session_id       │
         │  - event_type       │
         │  - timestamp        │
         │  - details          │
         └─────────┬───────────┘
                   │
                   ▼
         ┌─────────────────────┐
         │  Запись в           │
         │  anti_cheat_logs    │
         └─────────────────────┘
```

---

## Флоу работы администратора

### 1. Вход в админ-панель
```
┌──────────────────────┐
│   /login             │
│                      │
│  Админ вводит:       │
│  username: 'admin'   │
│  password: 'admin'   │
└──────┬───────────────┘
       │
       ▼
┌──────────────────────┐
│  POST /api/login     │
│                      │
│  Проверка role =     │
│  'admin'             │
└──────┬───────────────┘
       │
       ▼
┌──────────────────────┐
│  Сохранение токена   │
│  Переход на /admin   │
└──────────────────────┘
```

### 2. Админ-панель (`/admin`)
```
┌────────────────────────────────────────────────────┐
│                   ADMIN DASHBOARD                  │
│                                                    │
│  ┌──────────┐  ┌──────────┐  ┌──────────────────┐│
│  │ Задачи   │  │Кандидаты │  │ Настройки        ││
│  │ (Tasks)  │  │(Candidates)│ │ (Settings)      ││
│  └─────┬────┘  └─────┬────┘  └─────┬────────────┘│
└────────┼─────────────┼─────────────┼──────────────┘
         │             │             │
         │             │             │
    ┌────▼──────┐ ┌────▼─────┐ ┌────▼──────────┐
    │  Список   │ │  Список  │ │ Регистрация   │
    │  задач    │ │ кандидатов│ │ кандидатов   │
    │           │ │           │ │               │
    │ - Просмотр│ │ - Имя     │ │ POST /api/    │
    │ - Экспорт │ │ - Уровень │ │ register      │
    │   в CSV   │ │ - Баллы   │ │               │
    │           │ │ - Результ.│ │ Изменение     │
    │           │ │   челленджа│ │ пароля админа│
    │           │ │           │ │               │
    │           │ │ - Просмотр│ │ POST /api/    │
    │           │ │   логов   │ │ change-       │
    │           │ │   анти-   │ │ password      │
    │           │ │   чита    │ │               │
    └───────────┘ └───────────┘ └───────────────┘
```

### 3. Создание задач
```
┌──────────────────────┐
│  Вкладка "Upload"    │
│  или "Создать"       │
└──────┬───────────────┘
       │
       ▼
┌──────────────────────┐
│  Форма создания:     │
│                      │
│  - Название          │
│  - Описание          │
│  - Уровень сложности │
│  - Примеры (JSON)    │
│  - Тесты (JSON)      │
└──────┬───────────────┘
       │
       ▼
┌──────────────────────┐
│  POST /api/tasks     │
│                      │
│  Валидация:          │
│  - JSON корректность │
│  - Обязательные поля │
└──────┬───────────────┘
       │
       ▼
┌──────────────────────┐
│  Запись в tasks      │
│  Обновление списка   │
└──────────────────────┘
```

### 4. Просмотр результатов кандидатов
```
┌──────────────────────────────┐
│  Вкладка "Кандидаты"         │
│                              │
│  GET /api/challenges/        │
│  user/:userId                │
└──────┬───────────────────────┘
       │
       ▼
┌──────────────────────────────┐
│  Отображение:                │
│                              │
│  ┌────────────────────────┐  │
│  │ Кандидат: John Doe     │  │
│  │ Уровень: Middle        │  │
│  │ Дата: 2025-11-27       │  │
│  │                        │  │
│  │ Челлендж #1:           │  │
│  │ - Задачи: 3/3          │  │
│  │ - Решено: 2/3          │  │
│  │ - Время: 45 мин        │  │
│  │                        │  │
│  │ [Просмотр деталей]     │  │
│  │ [Логи анти-чита]       │  │
│  └────────────────────────┘  │
└───────────────────────────────┘
       │
       │ При клике на детали
       ▼
┌──────────────────────────────┐
│  Подробная информация:       │
│                              │
│  Задача 1: Sum of Two        │
│  Статус: ✅ Passed           │
│  Код:                        │
│  ```javascript               │
│  function sum(a, b) {        │
│    return a + b;             │
│  }                           │
│  ```                         │
│                              │
│  Задача 2: Reverse String    │
│  Статус: ✅ Passed           │
│                              │
│  Задача 3: FizzBuzz          │
│  Статус: ❌ Failed           │
└──────────────────────────────┘
       │
       │ При клике на логи
       ▼
┌──────────────────────────────┐
│  Анти-чит логи:              │
│                              │
│  15:30:22 - PASTE            │
│  Вставлено: "function sum"   │
│                              │
│  15:32:10 - BLUR             │
│  Переключение окна           │
│                              │
│  15:33:45 - VISIBILITY       │
│  Переключение вкладки        │
└──────────────────────────────┘
```

### 5. Экспорт данных
```
┌──────────────────────┐
│  Кнопка              │
│  "Экспорт в CSV"     │
└──────┬───────────────┘
       │
       ▼
┌──────────────────────┐
│  Формирование CSV:   │
│                      │
│  ID, Кандидат,       │
│  Уровень, Дата,      │
│  Баллы, Статус       │
└──────┬───────────────┘
       │
       ▼
┌──────────────────────┐
│  Скачивание файла    │
│  results.csv         │
└──────────────────────┘
```

---

## AI интеграция

### OpenAI-compatible API (SciBox)
Система использует OpenAI-compatible API для следующих функций:

#### 1. Ревью кода
```
POST /api/review

Request:
{
  "code": "function sum(a, b) { return a + b; }",
  "task": "Write a function sum that adds two numbers"
}

Response:
{
  "review": {
    "strengths": ["Clean code", "Good naming"],
    "weaknesses": ["No type checking"],
    "suggestions": ["Add input validation"],
    "score": 8
  }
}
```

#### 2. Генерация задач
```
POST /api/tasks/generate

Request:
{
  "level": "middle",
  "topic": "algorithms"
}

Response:
{
  "title": "Two Sum Problem",
  "description": "...",
  "examples": [...],
  "tests": [...]
}
```

### Переменные окружения
```bash
OPENAI_API_KEY=your_api_key
OPENAI_BASE_URL=https://llm.t1v.scibox.tech/v1
OPENAI_MODEL=qwen3-coder-30b-a3b-instruct-fp8
OPENAI_API_MAX_TOKENS=-1
ENABLE_AI_TASK_GEN=true  # Автогенерация задач
```

---

## Безопасность

### 1. Аутентификация
- SHA256 хеширование паролей (⚠️ не bcrypt)
- Токены хранятся в localStorage
- Проверка роли при доступе к защищенным маршрутам

### 2. Песочница кода
- VM-изоляция контекста выполнения
- Таймауты: 1000ms для кода, 500ms для тестов
- Блокировка `eval()`, `Function()`
- Нет доступа к `require`, `process`, `fs`

**⚠️ НЕ защищено от:**
- Бесконечных циклов
- Чрезмерной памяти
- Сетевых запросов

### 3. Анти-чит
- Логирование copy/paste
- Отслеживание переключения окон/вкладок
- Статический анализ кода (подозрительно короткие решения)

---

## Docker архитектура

```
┌─────────────────────────────────────────────────────┐
│              docker-compose.yml                     │
│                                                     │
│  ┌──────────────────┐      ┌──────────────────┐   │
│  │   frontend       │      │   backend        │   │
│  │   (Nginx)        │      │   (Node.js)      │   │
│  │   Port: 5173     │◀────▶│   Port: 3001     │   │
│  └────────┬─────────┘      └────────┬─────────┘   │
│           │                         │              │
│           │                         ▼              │
│           │                 ┌───────────────┐      │
│           │                 │  db-data      │      │
│           │                 │  Volume       │      │
│           │                 │  (SQLite)     │      │
│           │                 └───────────────┘      │
│           │                                         │
│           ▼                                         │
│  ┌──────────────────┐                              │
│  │  nginx.conf      │                              │
│  │  - SPA routing   │                              │
│  │  - /api proxy    │                              │
│  └──────────────────┘                              │
└─────────────────────────────────────────────────────┘
```

### Контейнеры:
1. **Frontend**: Multi-stage build (Node.js → Nginx)
2. **Backend**: Node.js 18-alpine
3. **Network**: vibecode-network (bridge)
4. **Volume**: db-data (персистентность БД)

---

## Дальнейшие улучшения

### Безопасность
- [ ] Миграция с SHA256 на bcrypt
- [ ] JWT с expiration вместо простых токенов
- [ ] Docker-изоляция для выполнения кода
- [ ] Rate limiting на API endpoints
- [ ] HTTPS/SSL в production

### Функционал
- [ ] Поддержка Python, Java, C++
- [ ] Видео-прокторинг
- [ ] Real-time collaboration
- [ ] Интерактивный дебаггер
- [ ] Детекция плагиата кода
- [ ] Расширенная аналитика

### Масштабируемость
- [ ] Миграция с SQLite на PostgreSQL
- [ ] Redis для кэширования
- [ ] Очередь задач (Bull, RabbitMQ)
- [ ] Kubernetes для оркестрации

---

## Заключение

**VibeCode Jam** — это MVP платформа для технических собеседований, построенная на современном стеке технологий. Архитектура разделена на два основных компонента:

1. **Frontend (React)** — отвечает за UI/UX, аутентификацию, редактор кода и отслеживание активности
2. **Backend (Node.js)** — API сервер с SQLite базой данных, песочницей выполнения кода и AI интеграцией

Система поддерживает полный цикл технического собеседования: от квалификационного теста до челленджа с тремя задачами и детальной аналитики результатов для рекрутеров.

**Ключевые преимущества:**
- ✅ Браузерный IDE с Monaco Editor
- ✅ Адаптивная сложность на основе квалификации
- ✅ Анти-чит механизмы
- ✅ AI-powered ревью кода
- ✅ Простая развертка через Docker

**Ограничения:**
- ⚠️ VM-изоляция не production-ready
- ⚠️ SHA256 вместо bcrypt
- ⚠️ SQLite не подходит для высокой нагрузки
- ⚠️ Нет многоязыковой поддержки

Для использования в production рекомендуется усилить безопасность выполнения кода, мигрировать на более надежные методы аутентификации и использовать масштабируемую базу данных.
